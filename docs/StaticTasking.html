<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Taskflow Handbook</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/x-icon" href="favicon.ico" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="taskflow_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://taskflow.github.io/">Taskflow</a>
   &#160;<span id="projectnumber">3.2.0-Master-Branch</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('StaticTasking.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Static Tasking</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#CreateATaskDependencyGraph">Create a Task Dependency Graph</a></li>
<li class="level1"><a href="#VisualizeATaskDependencyGraph">Visualize a Task Dependency Graph</a></li>
<li class="level1"><a href="#ModifyTaskAttributes">Modify Task Attributes</a></li>
<li class="level1"><a href="#TraverseAdjacentTasks">Traverse Adjacent Tasks</a></li>
<li class="level1"><a href="#AttachUserDataToATask">Attach User Data to a Task</a></li>
<li class="level1"><a href="#UnderstandTheLifetimeOfATask">Understand the Lifetime of a Task</a></li>
<li class="level1"><a href="#MoveATaskflow">Move a Taskflow</a></li>
</ul>
</div>
<div class="textblock"><p>This chapter demonstrates how to create a static task dependency graph. Static tasking captures the static parallel structure of a decomposition and is defined only by the program itself. It has a flat task hierarchy and cannot spawn new tasks from a running dependency graph.</p>
<h1><a class="anchor" id="CreateATaskDependencyGraph"></a>
Create a Task Dependency Graph</h1>
<p>A task in Taskflow is a <em>callable</em> object for which the operation <a href="https://en.cppreference.com/w/cpp/utility/functional/invoke">std::invoke</a> is applicable. It can be either a functor, a lambda expression, a bind expression, or a class objects with <code>operator()</code> overloaded. All tasks are created from <a class="el" href="classtf_1_1Taskflow.html" title="class to create a taskflow object">tf::Taskflow</a>, the class that manages a task dependency graph. Taskflow provides two methods, <a class="el" href="classtf_1_1FlowBuilder.html#acab0b4ac82260f47fdb36a3244ee3aaf" title="creates a placeholder task">tf::Taskflow::placeholder</a> and <a class="el" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57" title="creates a static task">tf::Taskflow::emplace</a> to create a task.</p>
<div class="fragment"><div class="line">1: <a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow;</div>
<div class="line">2: <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> A = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#acab0b4ac82260f47fdb36a3244ee3aaf">placeholder</a>();</div>
<div class="line">3: <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> B = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;task B\n&quot;</span>; });</div>
<div class="line">4:</div>
<div class="line">5: <span class="keyword">auto</span> [D, E, F] = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>(</div>
<div class="line">6:   [](){ <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Task A\n&quot;</span>; },</div>
<div class="line">7:   [](){ <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Task B\n&quot;</span>; },</div>
<div class="line">8:   [](){ <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Task C\n&quot;</span>; }</div>
<div class="line">9: );</div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a></div></div>
<div class="ttc" id="aclasstf_1_1FlowBuilder_html_a60d7a666cab71ecfa3010b2efb0d6b57"><div class="ttname"><a href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">tf::FlowBuilder::emplace</a></div><div class="ttdeci">Task emplace(C &amp;&amp;callable)</div><div class="ttdoc">creates a static task</div><div class="ttdef"><b>Definition</b> flow_builder.hpp:742</div></div>
<div class="ttc" id="aclasstf_1_1FlowBuilder_html_acab0b4ac82260f47fdb36a3244ee3aaf"><div class="ttname"><a href="classtf_1_1FlowBuilder.html#acab0b4ac82260f47fdb36a3244ee3aaf">tf::FlowBuilder::placeholder</a></div><div class="ttdeci">Task placeholder()</div><div class="ttdoc">creates a placeholder task</div><div class="ttdef"><b>Definition</b> flow_builder.hpp:820</div></div>
<div class="ttc" id="aclasstf_1_1Task_html"><div class="ttname"><a href="classtf_1_1Task.html">tf::Task</a></div><div class="ttdoc">class to create a task handle over a node in a taskflow graph</div><div class="ttdef"><b>Definition</b> task.hpp:187</div></div>
<div class="ttc" id="aclasstf_1_1Taskflow_html"><div class="ttname"><a href="classtf_1_1Taskflow.html">tf::Taskflow</a></div><div class="ttdoc">class to create a taskflow object</div><div class="ttdef"><b>Definition</b> core/taskflow.hpp:73</div></div>
</div><!-- fragment --><p>Debrief: </p><ul>
<li>Line 1 creates a taskflow object, or a <em>graph</em> </li>
<li>Line 2 creates a placeholder task without work (i.e., callable) </li>
<li>Line 3 creates a task from a given callable object and returns a task handle </li>
<li>Lines 5-9 create three tasks in one call using C++ structured binding coupled with <a class="elRef" href="http://en.cppreference.com/w/cpp/utility/tuple.html">std::tuple</a></li>
</ul>
<p>Each time you create a task, the taskflow object creates a node in the task graph and returns a task handle of type <a class="el" href="classtf_1_1Task.html" title="class to create a task handle over a node in a taskflow graph">tf::Task</a>. A task handle is a lightweight object that wraps up a particular node in a graph and provides a set of methods for you to assign different attributes to the task such as adding dependencies, naming, and assigning a new work.</p>
<div class="fragment"><div class="line"> 1: <a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow;</div>
<div class="line"> 2: <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> A = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;create a task A\n&quot;</span>; });</div>
<div class="line"> 3: <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> B = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;create a task B\n&quot;</span>; });</div>
<div class="line"> 4:</div>
<div class="line"> 5: A.<a class="code hl_function" href="classtf_1_1Task.html#a08ada0425b490997b6ff7f310107e5e3">name</a>(<span class="stringliteral">&quot;TaskA&quot;</span>);</div>
<div class="line"> 6: A.<a class="code hl_function" href="classtf_1_1Task.html#a2f6f4cec42d016e5eb89390f362ffe99">work</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;reassign A to a new callable\n&quot;</span>; });</div>
<div class="line"> 7: A.<a class="code hl_function" href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">precede</a>(B);</div>
<div class="line"> 8:</div>
<div class="line"> 9: <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; A.<a class="code hl_function" href="classtf_1_1Task.html#a08ada0425b490997b6ff7f310107e5e3">name</a>() &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;            <span class="comment">// TaskA</span></div>
<div class="line">10: <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; A.<a class="code hl_function" href="classtf_1_1Task.html#a1a0afc89e8a6a416c511e74d82df135d">num_successors</a>() &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;  <span class="comment">// 1</span></div>
<div class="line">11: <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; A.<a class="code hl_function" href="classtf_1_1Task.html#a974dc1d738b62b829ad261beeafbd67c">num_dependents</a>() &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;  <span class="comment">// 0</span></div>
<div class="line">12: </div>
<div class="line">13: <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; B.<a class="code hl_function" href="classtf_1_1Task.html#a1a0afc89e8a6a416c511e74d82df135d">num_successors</a>() &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;  <span class="comment">// 0</span></div>
<div class="line">14: <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; B.<a class="code hl_function" href="classtf_1_1Task.html#a974dc1d738b62b829ad261beeafbd67c">num_dependents</a>() &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;  <span class="comment">// 1</span></div>
<div class="ttc" id="aclasstf_1_1Task_html_a08ada0425b490997b6ff7f310107e5e3"><div class="ttname"><a href="classtf_1_1Task.html#a08ada0425b490997b6ff7f310107e5e3">tf::Task::name</a></div><div class="ttdeci">const std::string &amp; name() const</div><div class="ttdoc">queries the name of the task</div><div class="ttdef"><b>Definition</b> task.hpp:499</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a1a0afc89e8a6a416c511e74d82df135d"><div class="ttname"><a href="classtf_1_1Task.html#a1a0afc89e8a6a416c511e74d82df135d">tf::Task::num_successors</a></div><div class="ttdeci">size_t num_successors() const</div><div class="ttdoc">queries the number of successors of the task</div><div class="ttdef"><b>Definition</b> task.hpp:519</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a2f6f4cec42d016e5eb89390f362ffe99"><div class="ttname"><a href="classtf_1_1Task.html#a2f6f4cec42d016e5eb89390f362ffe99">tf::Task::work</a></div><div class="ttdeci">Task &amp; work(C &amp;&amp;callable)</div><div class="ttdoc">assigns a callable</div><div class="ttdef"><b>Definition</b> task.hpp:582</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a8c78c453295a553c1c016e4062da8588"><div class="ttname"><a href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">tf::Task::precede</a></div><div class="ttdeci">Task &amp; precede(Ts &amp;&amp;... tasks)</div><div class="ttdoc">adds precedence links from this to other tasks</div><div class="ttdef"><b>Definition</b> task.hpp:420</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a974dc1d738b62b829ad261beeafbd67c"><div class="ttname"><a href="classtf_1_1Task.html#a974dc1d738b62b829ad261beeafbd67c">tf::Task::num_dependents</a></div><div class="ttdeci">size_t num_dependents() const</div><div class="ttdoc">queries the number of predecessors of the task</div><div class="ttdef"><b>Definition</b> task.hpp:504</div></div>
<div class="ttc" id="aendl_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a></div><div class="ttdeci">T endl(T... args)</div></div>
</div><!-- fragment --><p>Debrief: </p><ul>
<li>Line 1 creates a taskflow object </li>
<li>Lines 2-3 create two tasks A and B </li>
<li>Lines 5-6 assign a name and a work to task A, and add a precedence link to task B </li>
<li>Line 7 adds a dependency link from A to B </li>
<li>Lines 9-14 dump the task attributes</li>
</ul>
<p>Taskflow uses general-purpose polymorphic function wrapper, <a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>, to store and invoke a callable in a task. You need to follow its contract to create a task. For example, the callable to construct a task must be copyable, and thus the code below won't compile:</p>
<div class="fragment"><div class="line">taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([ptr=<a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/utility/forward.html">std::make_unique&lt;int&gt;</a>(1)](){</div>
<div class="line">  <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;captured unique pointer is not copyable&quot;</span>;</div>
<div class="line">});</div>
<div class="ttc" id="aforward_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/forward.html">std::forward</a></div><div class="ttdeci">T forward(T... args)</div></div>
</div><!-- fragment --><h1><a class="anchor" id="VisualizeATaskDependencyGraph"></a>
Visualize a Task Dependency Graph</h1>
<p>You can dump a taskflow to a DOT format and visualize the graph using free online tools such as <a href="https://dreampuf.github.io/GraphvizOnline/">GraphvizOnline</a> and <a href="http://www.webgraphviz.com/">WebGraphviz</a>.</p>
<div class="fragment"><div class="line"> 1: #include &lt;taskflow/taskflow.hpp&gt;</div>
<div class="line"> 2:</div>
<div class="line"> 3: <span class="keywordtype">int</span> main() {</div>
<div class="line"> 4: </div>
<div class="line"> 5:   <a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow;</div>
<div class="line"> 6:</div>
<div class="line"> 7:   <span class="comment">// create a task dependency graph</span></div>
<div class="line"> 8:   <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> A = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Task A\n&quot;</span>; });</div>
<div class="line"> 9:   <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> B = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Task B\n&quot;</span>; });</div>
<div class="line">10:   <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> C = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Task C\n&quot;</span>; });</div>
<div class="line">11:   <a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> D = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([] () { <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Task D\n&quot;</span>; });</div>
<div class="line">12:</div>
<div class="line">13:   <span class="comment">// add dependency links</span></div>
<div class="line">14:   A.<a class="code hl_function" href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">precede</a>(B); </div>
<div class="line">15:   A.<a class="code hl_function" href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">precede</a>(C);</div>
<div class="line">16:   B.<a class="code hl_function" href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">precede</a>(D);</div>
<div class="line">17:   C.<a class="code hl_function" href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">precede</a>(D);</div>
<div class="line">18:</div>
<div class="line">19:   taskflow.<a class="code hl_function" href="classtf_1_1Taskflow.html#ac433018262e44b12c4cc9f0c4748d758">dump</a>(<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a>);</div>
<div class="line">20: }</div>
<div class="ttc" id="aclasstf_1_1Taskflow_html_ac433018262e44b12c4cc9f0c4748d758"><div class="ttname"><a href="classtf_1_1Taskflow.html#ac433018262e44b12c4cc9f0c4748d758">tf::Taskflow::dump</a></div><div class="ttdeci">void dump(std::ostream &amp;ostream) const</div><div class="ttdoc">dumps the taskflow to a DOT format through a std::ostream target</div><div class="ttdef"><b>Definition</b> core/taskflow.hpp:363</div></div>
</div><!-- fragment --><p>Debrief: </p><ul>
<li>Line 5 creates a taskflow object </li>
<li>Lines 8-11 create four tasks </li>
<li>Lines 14-17 add four task dependencies </li>
<li>Line 19 dumps the taskflow in the DOT format through standard output</li>
</ul>
<div class="dotgraph">
<img src="dot_simple.png" alt="dot_simple.png" border="0" usemap="#dot_simple.map"/>
</div>
<h1><a class="anchor" id="ModifyTaskAttributes"></a>
Modify Task Attributes</h1>
<p>This example demonstrates how to modify a task's attributes using methods defined in the task handler.</p>
<div class="fragment"><div class="line"> 1: #include &lt;taskflow/taskflow.hpp&gt;</div>
<div class="line"> 2:</div>
<div class="line"> 3: <span class="keywordtype">int</span> main() {</div>
<div class="line"> 4:</div>
<div class="line"> 5:   <a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow;</div>
<div class="line"> 6:</div>
<div class="line"> 7:   <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;tf::Task&gt;</a> tasks = { </div>
<div class="line"> 8:     taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#acab0b4ac82260f47fdb36a3244ee3aaf">placeholder</a>(),         <span class="comment">// create a task with no work</span></div>
<div class="line"> 9:     taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#acab0b4ac82260f47fdb36a3244ee3aaf">placeholder</a>()          <span class="comment">// create a task with no work</span></div>
<div class="line">10:   };</div>
<div class="line">11:</div>
<div class="line">12:   tasks[0].name(<span class="stringliteral">&quot;This is Task 0&quot;</span>);</div>
<div class="line">13:   tasks[1].name(<span class="stringliteral">&quot;This is Task 1&quot;</span>);</div>
<div class="line">14:   tasks[0].precede(tasks[1]);</div>
<div class="line">15:</div>
<div class="line">16:   <span class="keywordflow">for</span>(<span class="keyword">auto</span> task : tasks) {          <span class="comment">// print out each task&#39;s attributes</span></div>
<div class="line">17:     <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; task.name() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line">18:               &lt;&lt; <span class="stringliteral">&quot;num_dependents=&quot;</span> &lt;&lt; task.num_dependents() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">19:               &lt;&lt; <span class="stringliteral">&quot;num_successors=&quot;</span> &lt;&lt; task.num_successors() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">20:   }</div>
<div class="line">21:</div>
<div class="line">22:   taskflow.<a class="code hl_function" href="classtf_1_1Taskflow.html#ac433018262e44b12c4cc9f0c4748d758">dump</a>(<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a>);         <span class="comment">// dump the taskflow graph</span></div>
<div class="line">23:</div>
<div class="line">24:   tasks[0].work([](){ <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;got a new work!\n&quot;</span>; });</div>
<div class="line">25:   tasks[1].work([](){ <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;got a new work!\n&quot;</span>; });</div>
<div class="line">26:</div>
<div class="line">27:   <span class="keywordflow">return</span> 0;</div>
<div class="line">28: }</div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --><p>The output of this program looks like the following:</p>
<div class="fragment"><div class="line">This is Task 0: num_dependents=0, num_successors=1</div>
<div class="line">This is Task 1: num_dependents=1, num_successors=0</div>
<div class="line">digraph Taskflow {</div>
<div class="line">&quot;This is Task 1&quot;;</div>
<div class="line">&quot;This is Task 0&quot;;</div>
<div class="line">&quot;This is Task 0&quot; -&gt; &quot;This is Task 1&quot;;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Debrief: </p><ul>
<li>Line 5 creates a taskflow object </li>
<li>Lines 7-10 create two placeholder tasks with no works and stores the corresponding task handles in a vector </li>
<li>Lines 12-13 name the two tasks with human-readable strings </li>
<li>Line 14 adds a dependency link from the first task to the second task </li>
<li>Lines 16-20 print out the name of each task, the number of dependents, and the number of successors </li>
<li>Line 22 dumps the task dependency graph to a <a href="https://dreampuf.github.io/GraphvizOnline/">GraphViz Online</a> format (dot) </li>
<li>Lines 24-25 assign a new target to each task</li>
</ul>
<p>You can change the name and work of a task at anytime before running the graph. The later assignment overwrites the previous values.</p>
<h1><a class="anchor" id="TraverseAdjacentTasks"></a>
Traverse Adjacent Tasks</h1>
<p>You can iterate the successor list and the dependent list of a task by using <a class="el" href="classtf_1_1Task.html#aff13a503d4a3c994eb08cb6f22e1b427" title="applies an visitor callable to each successor of the task">tf::Task::for_each_successor</a> and <a class="el" href="classtf_1_1Task.html#a3bf68937662bf291637e4a763476b2e4" title="applies an visitor callable to each dependents of the task">tf::Task::for_each_dependent</a>, respectively. Each method takes a lambda and applies it to a successor or a dependent being traversed.</p>
<div class="fragment"><div class="line"><span class="comment">// traverse all successors of my_task</span></div>
<div class="line">my_task.for_each_successor([s=0] (<a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> successor) <span class="keyword">mutable</span> {</div>
<div class="line">  <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;successor &quot;</span> &lt;&lt; s++ &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// traverse all dependents of my_task</span></div>
<div class="line">my_task.for_each_dependent([d=0] (<a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> dependent) <span class="keyword">mutable</span> {</div>
<div class="line">  <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;dependent &quot;</span> &lt;&lt; d++ &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="AttachUserDataToATask"></a>
Attach User Data to a Task</h1>
<p>You can attach custom data to a task using <a class="el" href="classtf_1_1Task.html#afd82ab6d6518d1142a72c4d2c97ff114" title="assigns pointer to user data">tf::Task::data(void*)</a> and access it using <a class="el" href="classtf_1_1Task.html#afd82ab6d6518d1142a72c4d2c97ff114" title="assigns pointer to user data">tf::Task::data()</a>. Each node in a taskflow is associated with a C-styled data pointer (i.e., <code>void*</code>) you can use to point to user data and access it in the body of a task callable. The following example attaches an integer to a task and accesses that integer through capturing the data in the callable.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> my_data = 5;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> task = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#acab0b4ac82260f47fdb36a3244ee3aaf">placeholder</a>();</div>
<div class="line">task.<a class="code hl_function" href="classtf_1_1Task.html#afd82ab6d6518d1142a72c4d2c97ff114">data</a>(&amp;my_data)</div>
<div class="line">    .<a class="code hl_function" href="classtf_1_1Task.html#a2f6f4cec42d016e5eb89390f362ffe99">work</a>([task](){</div>
<div class="line">      <span class="keywordtype">int</span> my_date = *<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span>*<span class="keyword">&gt;</span>(task.<a class="code hl_function" href="classtf_1_1Task.html#afd82ab6d6518d1142a72c4d2c97ff114">data</a>());</div>
<div class="line">      <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;my_data: &quot;</span> &lt;&lt; my_data; </div>
<div class="line">    });</div>
<div class="ttc" id="aclasstf_1_1Task_html_afd82ab6d6518d1142a72c4d2c97ff114"><div class="ttname"><a href="classtf_1_1Task.html#afd82ab6d6518d1142a72c4d2c97ff114">tf::Task::data</a></div><div class="ttdeci">Task &amp; data(void *data)</div><div class="ttdoc">assigns pointer to user data</div><div class="ttdef"><b>Definition</b> task.hpp:614</div></div>
</div><!-- fragment --><p>Notice that you need to create a placeholder task first before assigning it a work callable. Only this way can you capture that task in the lambda and access its attached data in the lambda body.</p>
<dl class="section attention"><dt>Attention</dt><dd>It is your responsibility to ensure that the attached data stay alive during the execution of its task.</dd></dl>
<h1><a class="anchor" id="UnderstandTheLifetimeOfATask"></a>
Understand the Lifetime of a Task</h1>
<p>A task lives with its graph and belongs to only a graph at a time, and is not destroyed until the graph gets cleaned up. The lifetime of a task refers to the user-given callable object, including captured values. As long as the graph is alive, all the associated tasks exist.</p>
<dl class="section attention"><dt>Attention</dt><dd>It is your responsibility to keep tasks and graph alive during their execution.</dd></dl>
<h1><a class="anchor" id="MoveATaskflow"></a>
Move a Taskflow</h1>
<p>You can construct or assign a taskflow from a <em>moved</em> taskflow. Moving a taskflow to another will result in transferring the underlying graph data structures from one to the other.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow1, taskflow3;</div>
<div class="line"> </div>
<div class="line">taskflow1.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([](){});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// move-construct taskflow2 from taskflow1</span></div>
<div class="line"><a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow2(<a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a>(taskflow1));</div>
<div class="line">assert(taskflow2.num_tasks() == 1 &amp;&amp; taskflow1.<a class="code hl_function" href="classtf_1_1Taskflow.html#af4f03bca084deb5c2228ac8936d33649">num_tasks</a>() == 0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// move-assign taskflow3 to taskflow2</span></div>
<div class="line">taskflow3 = <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a>(taskflow2);</div>
<div class="line">assert(taskflow3.<a class="code hl_function" href="classtf_1_1Taskflow.html#af4f03bca084deb5c2228ac8936d33649">num_tasks</a>() == 1 &amp;&amp; taskflow2.num_tasks() == 0);</div>
<div class="ttc" id="aclasstf_1_1Taskflow_html_af4f03bca084deb5c2228ac8936d33649"><div class="ttname"><a href="classtf_1_1Taskflow.html#af4f03bca084deb5c2228ac8936d33649">tf::Taskflow::num_tasks</a></div><div class="ttdeci">size_t num_tasks() const</div><div class="ttdoc">queries the number of tasks</div><div class="ttdef"><b>Definition</b> core/taskflow.hpp:323</div></div>
<div class="ttc" id="amove_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a></div><div class="ttdeci">T move(T... args)</div></div>
</div><!-- fragment --><p>You can only move a taskflow to another while that taskflow is not being run by an executor. Moving a running taskflow can result in undefined behavior. Please see <a class="el" href="ExecuteTaskflow.html#ExecuteATaskflowWithTransferredOwnership">Execute a Taskflow with Transferred Ownership</a> for more details. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="Cookbook.html">Cookbook</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
