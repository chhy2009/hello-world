<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Taskflow Handbook</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/x-icon" href="favicon.ico" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="taskflow_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://taskflow.github.io/">Taskflow</a>
   &#160;<span id="projectnumber">3.2.0-Master-Branch</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('BenchmarkTaskflow.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Benchmark Taskflow</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#CompileAndRunBenchmarks">Compile and Run Benchmarks</a></li>
<li class="level1"><a href="#ConfigureRunOptions">Configure Run Options</a><ul><li class="level2"><a href="#SpecifyTheRunModel">Specify the Run Model</a></li>
<li class="level2"><a href="#SpecifyTheNumberOfThreads">Specify the Number of Threads</a></li>
<li class="level2"><a href="#SpecifyTheNumberOfRounds">Specify the Number of Rounds</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="CompileAndRunBenchmarks"></a>
Compile and Run Benchmarks</h1>
<p>To build the benchmark code, enable the CMake option <code>TF_BUILD_BENCHMARKS</code> to <code>ON</code> as follows:</p>
<div class="fragment"><div class="line"># under /taskflow/build</div>
<div class="line">~$ cmake ../ -DTF_BUILD_BENCHMARKS=ON</div>
<div class="line">~$ make</div>
</div><!-- fragment --><p>After you successfully build the benchmark code, you can find all benchmark instances in the <code>benchmarks/</code> folder. You can run the executable of each instance in the corresponding folder.</p>
<div class="fragment"><div class="line">~$ cd benchmarks &amp; ls</div>
<div class="line">black_scholes binary_tree graph_traversal ...</div>
<div class="line">~$ cd graph_traversal &amp; ./graph_traversal</div>
<div class="line">|V|+|E|     Runtime</div>
<div class="line">      2       0.197</div>
<div class="line">    842       0.198</div>
<div class="line">   3284       0.488</div>
<div class="line">   7288       0.774</div>
<div class="line">    ...         ...</div>
<div class="line">    ...         ...</div>
<div class="line"> 619802      75.135</div>
<div class="line"> 664771      77.436</div>
<div class="line"> 711200      83.957</div>
</div><!-- fragment --><p>You can display the help message by giving the option <code>--help</code>.</p>
<div class="fragment"><div class="line">~$ ./graph_traversal --help</div>
<div class="line">Graph Traversal</div>
<div class="line">Usage: ./graph_traversal [OPTIONS]</div>
<div class="line"> </div>
<div class="line">Options:</div>
<div class="line">  -h,--help                   Print this help message and exit</div>
<div class="line">  -t,--num_threads UINT       number of threads (default=1)</div>
<div class="line">  -r,--num_rounds UINT        number of rounds (default=1)</div>
<div class="line">  -m,--model TEXT             model name tbb|omp|tf (default=tf)</div>
</div><!-- fragment --><p>We currently implement the following instances that are commonly used by the parallel computing community to evaluate the system performance.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Instance   </th><th class="markdownTableHeadCenter">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">binary_tree   </td><td class="markdownTableBodyCenter">traverses a complete binary tree    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">black_scholes   </td><td class="markdownTableBodyCenter">computes option pricing with Black-Shcoles Models    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">graph_traversal   </td><td class="markdownTableBodyCenter">traverses a randomly generated direct acyclic graph    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">linear_chain   </td><td class="markdownTableBodyCenter">traverses a linear chain of tasks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">mandelbrot   </td><td class="markdownTableBodyCenter">exploits imbalanced workloads in a Mandelbrot set    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">matrix_multiplication   </td><td class="markdownTableBodyCenter">multiplies two 2D matrices    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">mnist   </td><td class="markdownTableBodyCenter">trains a neural network-based image classifier on the MNIST dataset    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">parallel_sort   </td><td class="markdownTableBodyCenter">sorts a range of items    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">reduce_sum   </td><td class="markdownTableBodyCenter">sums a range of items using reduction    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">wavefront   </td><td class="markdownTableBodyCenter">propagates computations in a 2D grid    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">linear_pipeline   </td><td class="markdownTableBodyCenter">pipeline scheduling on a linear chain of pipes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">graph_pipeline   </td><td class="markdownTableBodyCenter">pipeline scheduling on a graph of pipes   </td></tr>
</table>
<h1><a class="anchor" id="ConfigureRunOptions"></a>
Configure Run Options</h1>
<p>We implement consistent options for each benchmark instance. Common options are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">option   </th><th class="markdownTableHeadCenter">value   </th><th class="markdownTableHeadCenter">function    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>-h</code>   </td><td class="markdownTableBodyCenter">none   </td><td class="markdownTableBodyCenter">display the help message    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>-t</code>   </td><td class="markdownTableBodyCenter">integer   </td><td class="markdownTableBodyCenter">configure the number of threads to run    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>-r</code>   </td><td class="markdownTableBodyCenter">integer   </td><td class="markdownTableBodyCenter">configure the number of rounds to run    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>-m</code>   </td><td class="markdownTableBodyCenter">string   </td><td class="markdownTableBodyCenter">configure the baseline models to run, tbb, omp, or tf   </td></tr>
</table>
<p>You can configure the benchmarking environment by giving different options.</p>
<h2><a class="anchor" id="SpecifyTheRunModel"></a>
Specify the Run Model</h2>
<p>In addition to a Taskflow-based implementation for each benchmark instance, we have implemented two baseline models using the state-of-the-art parallel programming libraries, <a href="https://www.openmp.org/">OpenMP</a> and <a href="https://github.com/oneapi-src/oneTBB">Intel TBB</a>, to measure and evaluate the performance of Taskflow. You can select different implementations by passing the option <code>-m</code>.</p>
<div class="fragment"><div class="line">~$ ./graph_traversal -m tf   # run the Taskflow implementation (default)</div>
<div class="line">~$ ./graph_traversal -m tbb  # run the TBB implementation</div>
<div class="line">~$ ./graph_traversal -m omp  # run the OpenMP implementation</div>
</div><!-- fragment --><h2><a class="anchor" id="SpecifyTheNumberOfThreads"></a>
Specify the Number of Threads</h2>
<p>You can configure the number of threads to run a benchmark instance by passing the option <code>-t</code>. The default value is one.</p>
<div class="fragment"><div class="line"># run the Taskflow implementation using 4 threads</div>
<div class="line">~$ ./graph_traversal -m tf -t 4</div>
</div><!-- fragment --><p>Depending on your environment, you may need to use <code>taskset</code> to set the CPU affinity of the running process. This allows the OS scheduler to keep process on the same CPU(s) as long as practical for performance reason.</p>
<div class="fragment"><div class="line"># affine the process to 4 CPUs, CPU 0, CPU 1, CPU 2, and CPU 3</div>
<div class="line">~$ taskset -c 0-3 graph_traversal -t 4  </div>
</div><!-- fragment --><h2><a class="anchor" id="SpecifyTheNumberOfRounds"></a>
Specify the Number of Rounds</h2>
<p>Each benchmark instance evaluates the runtime of the implementation at different problem sizes. Each problem size corresponds to one iteration. You can configure the number of rounds per iteration to average the runtime.</p>
<div class="fragment"><div class="line"># measure the runtime in an average of 10 runs</div>
<div class="line">~$ ./graph_traversal -r 10</div>
<div class="line">|V|+|E|     Runtime</div>
<div class="line">      2       0.109   # the runtime value 0.109 is an average of 10 runs</div>
<div class="line">    842       0.298</div>
<div class="line">    ...         ...</div>
<div class="line"> 619802      73.135</div>
<div class="line"> 664771      74.436</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="install.html">Building and Installing</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
