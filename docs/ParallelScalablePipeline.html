<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Taskflow Handbook</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/x-icon" href="favicon.ico" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="taskflow_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://taskflow.github.io/">Taskflow</a>
   &#160;<span id="projectnumber">3.2.0-Master-Branch</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ParallelScalablePipeline.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Parallel Scalable Pipeline</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#IncludeTheScalablePipelineHeader">Include the Header</a></li>
<li class="level1"><a href="#CreateAScalablePipelineModuleTask">Create a Scalable Pipeline Module Task</a></li>
<li class="level1"><a href="#ResetAPlaceholderScalablePipeline">Reset a Placeholder Scalable Pipeline</a></li>
<li class="level1"><a href="#ScalablePipelineUseOtherIteratorTypes">Use Other Iterator Types</a></li>
<li class="level1"><a href="#ParallelScalablePipelineLearnMore">Learn More about Taskflow Pipeline</a></li>
</ul>
</div>
<div class="textblock"><p>Unlike <a class="el" href="classtf_1_1Pipeline.html" title="class to create a pipeline scheduling framework">tf::Pipeline</a> (see <a class="el" href="ParallelPipeline.html">Parallel Pipeline</a>) that instantiates all pipes at the construction time, Taskflow provides a scalable alternative called <a class="el" href="classtf_1_1ScalablePipeline.html" title="class to create a scalable pipeline object">tf::ScalablePipeline</a> to allow variable assignments of pipes using range iterators. A scalable pipeline is thus more flexible for applications to create a pipeline scheduling framework whose pipeline structure depends on runtime variables.</p>
<h1><a class="anchor" id="IncludeTheScalablePipelineHeader"></a>
Include the Header</h1>
<p>You need to include the header file, <code>taskflow/algorithm/pipeline.hpp</code>, for creating a scalable pipeline scheduling framework.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="pipeline_8hpp.html">taskflow/algorithm/pipeline.hpp</a>&gt;</span></div>
<div class="ttc" id="apipeline_8hpp_html"><div class="ttname"><a href="pipeline_8hpp.html">pipeline.hpp</a></div><div class="ttdoc">pipeline include file</div></div>
</div><!-- fragment --><h1><a class="anchor" id="CreateAScalablePipelineModuleTask"></a>
Create a Scalable Pipeline Module Task</h1>
<p>Similar to <a class="el" href="classtf_1_1Pipeline.html" title="class to create a pipeline scheduling framework">tf::Pipeline</a>, <a class="el" href="classtf_1_1ScalablePipeline.html" title="class to create a scalable pipeline object">tf::ScalablePipeline</a> is a composable graph object to implement a <em>pipeline scheduling framework</em> in a taskflow. The key difference between <a class="el" href="classtf_1_1Pipeline.html" title="class to create a pipeline scheduling framework">tf::Pipeline</a> and <a class="el" href="classtf_1_1ScalablePipeline.html" title="class to create a scalable pipeline object">tf::ScalablePipeline</a> is that a scalable pipeline can accept <em>variable</em> assignments of pipes rather than instantiating all pipes at construction or programming time. Users define a linear range of pipes, each of the same callable type, and apply that range to construct a scalable pipeline. Between successive runs, users can reset the pipeline to a different range of pipes. The following code creates a scalable pipeline that uses four parallel lines to schedule tokens through three serial pipes in the given vector, then resetting that pipeline to a new range of five serial pipes:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow(<span class="stringliteral">&quot;pipeline&quot;</span>);</div>
<div class="line"><a class="code hl_class" href="classtf_1_1Executor.html">tf::Executor</a> executor;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> num_lines = 4;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create data storage</span></div>
<div class="line"><a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;int, num_lines&gt;</a> buffer;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// define the pipe callable</span></div>
<div class="line"><span class="keyword">auto</span> pipe_callable = [&amp;buffer] (<a class="code hl_class" href="classtf_1_1Pipeflow.html">tf::Pipeflow</a>&amp; pf) <span class="keyword">mutable</span> {</div>
<div class="line">  <span class="keywordflow">switch</span>(pf.pipe()) {</div>
<div class="line">    <span class="comment">// first stage generates only 5 scheduling tokens and saves the </span></div>
<div class="line">    <span class="comment">// token number into the buffer.</span></div>
<div class="line">    <span class="keywordflow">case</span> 0: {</div>
<div class="line">      <span class="keywordflow">if</span>(pf.token() == 5) {</div>
<div class="line">        pf.stop();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;stage 1: input token = %zu\n&quot;</span>, pf.token());</div>
<div class="line">        buffer[pf.line()] = pf.token();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// other stages propagate the previous result to this pipe and</span></div>
<div class="line">    <span class="comment">// increment it by one</span></div>
<div class="line">    <span class="keywordflow">default</span>: {</div>
<div class="line">      <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/c/fprintf.html">printf</a>(</div>
<div class="line">        <span class="stringliteral">&quot;stage %zu: input buffer[%zu] = %d\n&quot;</span>, pf.pipe(), pf.line(), buffer[pf.line()]</div>
<div class="line">      );</div>
<div class="line">      buffer[pf.line()] = buffer[pf.line()] + 1;</div>
<div class="line">    } </div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create a vector of three pipes</span></div>
<div class="line"><a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="code hl_class" href="classtf_1_1Pipe.html">tf::Pipe</a>&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt;void(<a class="code hl_class" href="classtf_1_1Pipeflow.html">tf::Pipeflow</a>&amp;)&gt;&gt; &gt; pipes;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;3; i++) {</div>
<div class="line">  pipes.emplace_back(<a class="code hl_enumvalue" href="namespacetf.html#abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0">tf::PipeType::SERIAL</a>, pipe_callable);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create a pipeline of four parallel lines based on the given vector of pipes</span></div>
<div class="line"><a class="code hl_class" href="classtf_1_1ScalablePipeline.html">tf::ScalablePipeline</a> pl(num_lines, pipes.begin(), pipes.end());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// build the pipeline graph using composition</span></div>
<div class="line"><a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> init = taskflow.emplace([](){ <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;ready\n&quot;</span>; })</div>
<div class="line">                        .name(<span class="stringliteral">&quot;starting pipeline&quot;</span>);</div>
<div class="line"><a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> task = taskflow.<a class="code hl_function" href="classtf_1_1Task.html#ab38be520fe700cb4ca1f312308a95585">composed_of</a>(pl)</div>
<div class="line">                        .<a class="code hl_function" href="classtf_1_1Task.html#a08ada0425b490997b6ff7f310107e5e3">name</a>(<span class="stringliteral">&quot;pipeline&quot;</span>);</div>
<div class="line"><a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> stop = taskflow.emplace([](){ <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;stopped\n&quot;</span>; })</div>
<div class="line">                        .name(<span class="stringliteral">&quot;pipeline stopped&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create task dependency</span></div>
<div class="line">init.<a class="code hl_function" href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">precede</a>(task);</div>
<div class="line">task.<a class="code hl_function" href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">precede</a>(stop);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// dump the pipeline graph structure (with composition)</span></div>
<div class="line">taskflow.<a class="code hl_function" href="classtf_1_1Task.html#a3318a49ff9d0a01cd1e8ee675251e3b7">dump</a>(<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// run the pipeline</span></div>
<div class="line">executor.<a class="code hl_function" href="classtf_1_1Executor.html#a519777f5783981d534e9e53b99712069">run</a>(taskflow).wait();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// reset the pipeline to a new range of five pipes and starts from</span></div>
<div class="line"><span class="comment">// the initial state (i.e., token counts from zero)</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;2; i++) {</div>
<div class="line">  pipes.emplace_back(<a class="code hl_enumvalue" href="namespacetf.html#abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0">tf::PipeType::SERIAL</a>, pipe_callable);</div>
<div class="line">}</div>
<div class="line">pl.reset(pipes.begin(), pipes.end());</div>
<div class="line"> </div>
<div class="line">executor.<a class="code hl_function" href="classtf_1_1Executor.html#a519777f5783981d534e9e53b99712069">run</a>(taskflow).wait();</div>
<div class="ttc" id="aarray_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a></div></div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a></div></div>
<div class="ttc" id="aclasstf_1_1Executor_html"><div class="ttname"><a href="classtf_1_1Executor.html">tf::Executor</a></div><div class="ttdoc">class to create an executor for running a taskflow graph</div><div class="ttdef"><b>Definition</b> executor.hpp:50</div></div>
<div class="ttc" id="aclasstf_1_1Executor_html_a519777f5783981d534e9e53b99712069"><div class="ttname"><a href="classtf_1_1Executor.html#a519777f5783981d534e9e53b99712069">tf::Executor::run</a></div><div class="ttdeci">tf::Future&lt; void &gt; run(Taskflow &amp;taskflow)</div><div class="ttdoc">runs a taskflow once</div><div class="ttdef"><b>Definition</b> executor.hpp:1573</div></div>
<div class="ttc" id="aclasstf_1_1Pipe_html"><div class="ttname"><a href="classtf_1_1Pipe.html">tf::Pipe</a></div><div class="ttdoc">class to create a pipe object for a pipeline stage</div><div class="ttdef"><b>Definition</b> pipeline.hpp:136</div></div>
<div class="ttc" id="aclasstf_1_1Pipeflow_html"><div class="ttname"><a href="classtf_1_1Pipeflow.html">tf::Pipeflow</a></div><div class="ttdoc">class to create a pipeflow object used by the pipe callable</div><div class="ttdef"><b>Definition</b> pipeline.hpp:42</div></div>
<div class="ttc" id="aclasstf_1_1ScalablePipeline_html"><div class="ttname"><a href="classtf_1_1ScalablePipeline.html">tf::ScalablePipeline</a></div><div class="ttdoc">class to create a scalable pipeline object</div><div class="ttdef"><b>Definition</b> pipeline.hpp:767</div></div>
<div class="ttc" id="aclasstf_1_1Task_html"><div class="ttname"><a href="classtf_1_1Task.html">tf::Task</a></div><div class="ttdoc">class to create a task handle over a node in a taskflow graph</div><div class="ttdef"><b>Definition</b> task.hpp:187</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a08ada0425b490997b6ff7f310107e5e3"><div class="ttname"><a href="classtf_1_1Task.html#a08ada0425b490997b6ff7f310107e5e3">tf::Task::name</a></div><div class="ttdeci">const std::string &amp; name() const</div><div class="ttdoc">queries the name of the task</div><div class="ttdef"><b>Definition</b> task.hpp:499</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a3318a49ff9d0a01cd1e8ee675251e3b7"><div class="ttname"><a href="classtf_1_1Task.html#a3318a49ff9d0a01cd1e8ee675251e3b7">tf::Task::dump</a></div><div class="ttdeci">void dump(std::ostream &amp;ostream) const</div><div class="ttdoc">dumps the task through an output stream</div><div class="ttdef"><b>Definition</b> task.hpp:573</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a8c78c453295a553c1c016e4062da8588"><div class="ttname"><a href="classtf_1_1Task.html#a8c78c453295a553c1c016e4062da8588">tf::Task::precede</a></div><div class="ttdeci">Task &amp; precede(Ts &amp;&amp;... tasks)</div><div class="ttdoc">adds precedence links from this to other tasks</div><div class="ttdef"><b>Definition</b> task.hpp:420</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_ab38be520fe700cb4ca1f312308a95585"><div class="ttname"><a href="classtf_1_1Task.html#ab38be520fe700cb4ca1f312308a95585">tf::Task::composed_of</a></div><div class="ttdeci">Task &amp; composed_of(T &amp;object)</div><div class="ttdoc">creates a module task from a taskflow</div><div class="ttdef"><b>Definition</b> task.hpp:436</div></div>
<div class="ttc" id="aclasstf_1_1Taskflow_html"><div class="ttname"><a href="classtf_1_1Taskflow.html">tf::Taskflow</a></div><div class="ttdoc">class to create a taskflow object</div><div class="ttdef"><b>Definition</b> core/taskflow.hpp:73</div></div>
<div class="ttc" id="afprintf_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/c/fprintf.html">std::printf</a></div><div class="ttdeci">T printf(T... args)</div></div>
<div class="ttc" id="afunction_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a></div></div>
<div class="ttc" id="anamespacetf_html_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0"><div class="ttname"><a href="namespacetf.html#abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0">tf::PipeType::SERIAL</a></div><div class="ttdeci">@ SERIAL</div><div class="ttdoc">serial type</div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --><p>The program defines a uniform pipe type of <code>tf::Pipe&lt;std::function&lt;void(tf::Pipeflow&amp;)&gt;&gt;</code> and keep all pipes in a vector that is amenable to change. Then, it constructs a scalable pipeline using two range iterators, <code>[first, last)</code>, that point to the beginning and the end of the pipe vector, resulting in a pipeline of three serial stages:</p>
<div class="dotgraph">
<img src="dot_scalable_pipeline_1.png" alt="dot_scalable_pipeline_1.png" border="0" usemap="#dot_scalable_pipeline_1.map"/>
</div>
<p>Then, the program appends another two pipes into the vector and resets the pipeline to the new range of two additional pipes, resulting in a pipeline of five serial stages:</p>
<div class="dotgraph">
<img src="dot_scalable_pipeline_2.png" alt="dot_scalable_pipeline_2.png" border="0" usemap="#dot_scalable_pipeline_2.map"/>
</div>
<p>When resetting a scalable pipeline to a new range, it will start from the initial state as if it has just been constructed, i.e., the token number counts from zero.</p>
<dl class="section attention"><dt>Attention</dt><dd>Unlike <a class="el" href="classtf_1_1Pipeline.html" title="class to create a pipeline scheduling framework">tf::Pipeline</a> that keeps the given pipes in a <a class="elRef" href="http://en.cppreference.com/w/cpp/utility/tuple.html">std::tuple</a> object, <a class="el" href="classtf_1_1ScalablePipeline.html" title="class to create a scalable pipeline object">tf::ScalablePipeline</a> does not own the given pipe but maintains a vector of iterators to each pipe in the given range. It is your responsibility to keep those pipe objects alive during the execution of the pipeline task.</dd></dl>
<h1><a class="anchor" id="ResetAPlaceholderScalablePipeline"></a>
Reset a Placeholder Scalable Pipeline</h1>
<p>It is possible to create a scalable pipeline as a placeholder using the constructor <a class="el" href="classtf_1_1ScalablePipeline.html" title="class to create a scalable pipeline object">tf::ScalablePipeline(size_t num_lines)</a> and reset it to another range later in the application. The following code creates a task to emplace a range of pipes and reset the pipeline to that range, before running the pipeline task:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classtf_1_1Executor.html">tf::Executor</a> executor;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1Taskflow.html">tf::Taskflow</a> taskflow;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">size_t</span> num_pipes = 10;</div>
<div class="line"><span class="keywordtype">size_t</span> num_lines = 10;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="code hl_class" href="classtf_1_1Pipe.html">tf::Pipe</a>&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt;void(<a class="code hl_class" href="classtf_1_1Pipeflow.html">tf::Pipeflow</a>&amp;)&gt;&gt;&gt; pipes;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1ScalablePipeline.html">tf::ScalablePipeline</a>&lt;<span class="keyword">typename</span> <span class="keyword">decltype</span>(pipes)::iterator&gt; spl(num_lines); </div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> init = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">emplace</a>([&amp;](){</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;num_pipes; i++) {</div>
<div class="line">    pipes.emplace_back(<a class="code hl_enumvalue" href="namespacetf.html#abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0">tf::PipeType::SERIAL</a>, [&amp;](<a class="code hl_class" href="classtf_1_1Pipeflow.html">tf::Pipeflow</a>&amp; pf) { </div>
<div class="line">      <span class="keywordflow">if</span>(pf.<a class="code hl_function" href="classtf_1_1Pipeflow.html#a4914c1f381a3016e98285b019cf60d6d">pipe</a>() == 0 &amp;&amp; pf.<a class="code hl_function" href="classtf_1_1Pipeflow.html#a295e5d884665c076f4ef5d78139f7c51">token</a>() == 1024) {</div>
<div class="line">        pf.stop();</div>
<div class="line">        return;</div>
<div class="line">      }</div>
<div class="line">    });</div>
<div class="line">  }</div>
<div class="line">  spl.reset(pipes.begin(), pipes.end());</div>
<div class="line">}).name(<span class="stringliteral">&quot;init&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classtf_1_1Task.html">tf::Task</a> pipeline = taskflow.<a class="code hl_function" href="classtf_1_1FlowBuilder.html#ac6f22228d4c2ea2e643c4b0d42c0e92a">composed_of</a>(spl).<a class="code hl_function" href="classtf_1_1Task.html#a08ada0425b490997b6ff7f310107e5e3">name</a>(<span class="stringliteral">&quot;pipeline&quot;</span>);</div>
<div class="line">pipeline.<a class="code hl_function" href="classtf_1_1Task.html#a331b1b726555072e7c7d10941257f664">succeed</a>(init);</div>
<div class="line">executor.<a class="code hl_function" href="classtf_1_1Executor.html#a519777f5783981d534e9e53b99712069">run</a>(taskflow).wait();  </div>
<div class="ttc" id="aclasstf_1_1FlowBuilder_html_a60d7a666cab71ecfa3010b2efb0d6b57"><div class="ttname"><a href="classtf_1_1FlowBuilder.html#a60d7a666cab71ecfa3010b2efb0d6b57">tf::FlowBuilder::emplace</a></div><div class="ttdeci">Task emplace(C &amp;&amp;callable)</div><div class="ttdoc">creates a static task</div><div class="ttdef"><b>Definition</b> flow_builder.hpp:742</div></div>
<div class="ttc" id="aclasstf_1_1FlowBuilder_html_ac6f22228d4c2ea2e643c4b0d42c0e92a"><div class="ttname"><a href="classtf_1_1FlowBuilder.html#ac6f22228d4c2ea2e643c4b0d42c0e92a">tf::FlowBuilder::composed_of</a></div><div class="ttdeci">Task composed_of(T &amp;object)</div><div class="ttdoc">creates a module task for the target object</div><div class="ttdef"><b>Definition</b> flow_builder.hpp:812</div></div>
<div class="ttc" id="aclasstf_1_1Pipeflow_html_a295e5d884665c076f4ef5d78139f7c51"><div class="ttname"><a href="classtf_1_1Pipeflow.html#a295e5d884665c076f4ef5d78139f7c51">tf::Pipeflow::token</a></div><div class="ttdeci">size_t token() const</div><div class="ttdoc">queries the token identifier</div><div class="ttdef"><b>Definition</b> pipeline.hpp:74</div></div>
<div class="ttc" id="aclasstf_1_1Pipeflow_html_a4914c1f381a3016e98285b019cf60d6d"><div class="ttname"><a href="classtf_1_1Pipeflow.html#a4914c1f381a3016e98285b019cf60d6d">tf::Pipeflow::pipe</a></div><div class="ttdeci">size_t pipe() const</div><div class="ttdoc">queries the pipe identifier of the present token</div><div class="ttdef"><b>Definition</b> pipeline.hpp:67</div></div>
<div class="ttc" id="aclasstf_1_1Task_html_a331b1b726555072e7c7d10941257f664"><div class="ttname"><a href="classtf_1_1Task.html#a331b1b726555072e7c7d10941257f664">tf::Task::succeed</a></div><div class="ttdeci">Task &amp; succeed(Ts &amp;&amp;... tasks)</div><div class="ttdoc">adds precedence links from other tasks to this</div><div class="ttdef"><b>Definition</b> task.hpp:428</div></div>
</div><!-- fragment --><p>The task graph of this program is shown below:</p>
<div class="dotgraph">
<img src="dot_scalable_pipeline_3.png" alt="dot_scalable_pipeline_3.png" border="0" usemap="#dot_scalable_pipeline_3.map"/>
</div>
<dl class="section attention"><dt>Attention</dt><dd>It is your responsibility to ensure a scalable pipeline has a valid structure before running it. A valid pipeline must have at least one parallel line and one pipe, where the first pipe is a serial type.</dd></dl>
<p>Similarly, you can create an empty scalable pipeline using the default constructor <a class="el" href="classtf_1_1ScalablePipeline.html" title="class to create a scalable pipeline object">tf::ScalablePipeline()</a> and reset it later in your program.</p>
<div class="fragment"><div class="line"><a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="code hl_class" href="classtf_1_1Pipe.html">tf::Pipe</a>&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt;void(<a class="code hl_class" href="classtf_1_1Pipeflow.html">tf::Pipeflow</a>&amp;)&gt;&gt;&gt; pipes;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1ScalablePipeline.html">tf::ScalablePipeline</a>&lt;<span class="keyword">typename</span> <span class="keyword">decltype</span>(pipes)::iterator&gt; spl; </div>
<div class="line"><span class="comment">// create pipes ...</span></div>
<div class="line">spl.<a class="code hl_function" href="classtf_1_1ScalablePipeline.html#a940a8de7b53ac5cbd59c55091d88c88f">reset</a>(num_lines, pipes.begin(), pipes.end());</div>
<div class="ttc" id="aclasstf_1_1ScalablePipeline_html_a940a8de7b53ac5cbd59c55091d88c88f"><div class="ttname"><a href="classtf_1_1ScalablePipeline.html#a940a8de7b53ac5cbd59c55091d88c88f">tf::ScalablePipeline::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">resets the pipeline</div><div class="ttdef"><b>Definition</b> pipeline.hpp:1069</div></div>
</div><!-- fragment --><h1><a class="anchor" id="ScalablePipelineUseOtherIteratorTypes"></a>
Use Other Iterator Types</h1>
<p>When assigning a range to a scalable pipeline, the pipeline fetches all pipe iterators in that range to an internal vector. This organization allows invoking a pipe callable to be a random accessible operation, regardless of the pipe container type. Taskflow does not have much restriction on the iterator type, as long as these pipes can be iterated in a sequential order using the postfix increment operator, <code>++</code>.</p>
<div class="fragment"><div class="line"><span class="comment">// use vector to store pipes</span></div>
<div class="line"><a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="code hl_class" href="classtf_1_1Pipe.html">tf::Pipe</a>&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt;void(<a class="code hl_class" href="classtf_1_1Pipeflow.html">tf::Pipeflow</a>&amp;)&gt;&gt;&gt; vector;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1ScalablePipeline.html">tf::ScalablePipeline</a> spl1(num_lines, vector.begin(), vector.end());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// use list to store pipes</span></div>
<div class="line"><a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/container/list.html">std::list</a>&lt;<a class="code hl_class" href="classtf_1_1Pipe.html">tf::Pipe</a>&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt;void(<a class="code hl_class" href="classtf_1_1Pipeflow.html">tf::Pipeflow</a>&amp;)&gt;&gt;&gt; list;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1ScalablePipeline.html">tf::ScalablePipeline</a> spl2(num_lines, list.begin(), list.end());</div>
<div class="ttc" id="alist_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/list.html">std::list</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="ParallelScalablePipelineLearnMore"></a>
Learn More about Taskflow Pipeline</h1>
<p>Visit the following pages to learn more about pipeline:</p>
<ol type="1">
<li><a class="el" href="ParallelPipeline.html">Parallel Pipeline</a></li>
<li><a class="el" href="TextProcessingPipeline.html">Text Processing Pipeline</a></li>
<li><a class="el" href="GraphProcessingPipeline.html">Graph Processing Pipeline</a></li>
<li><a class="el" href="TaskflowProcessingPipeline.html">Taskflow Processing Pipeline</a> </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="Algorithms.html">Taskflow Algorithms</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
